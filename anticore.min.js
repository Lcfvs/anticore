/* Copyright MIT 2017 Lcf.vs - https://github.com/Lcfvs/anticore */
!function(e){"use strict";function t(e,t){return Object.create(e||null,t)}function n(e,t){return(t||v).querySelectorAll(e)}function r(e){(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(this.search+="&"+b(("option"===e.nodeName.toLowerCase()?e.parentNode:e).name)+"="+b(e.value).replace(/%20/g,"+"))}function o(){L.shift(),L.length&&i()}function i(){var e;if(!L[1])return e=L[0],x(e.request.url,e.request.options).then(u).then(s).then(e.trigger||e.request.resolve).then(o).catch(e.reject)}function u(e){var t,n;return t=((e.headers.get("content-type")||"application/octet-stream").match(/json|html|svg|xml|text(?=\/plain)/)||["blob"])[0],n=L[0],n.type=t,n.request.response=e,e[O.indexOf(t)>-1?"text":t]()}function s(e){var t;return t=L[0],O.indexOf(t.type)>-1?t.request.response.result=w(e):t.request.response.result=e,t.request}function c(e){var t;if(!(t=this.shift()))return e&&e();t[0](t[1],this.next,this.loaded)}function a(e){var t,r;(t=this).selector=e,r=n(e,t.container),j(r,f,t)}function f(e){var t;(t=this).element=e,j(k[t.selector],h,t)}function h(e){this.push([e,this.element,this.loaded])}function d(e,t){return new Promise(function(n){var r;(r=[]).container=e,r.loaded=t,j(Object.keys(k),a,r),r.next=c.bind(r,n),r.next()})}function l(e){j(n(".error",e.target),p),E.fetchFromEvent(e)}function p(e){e.parentNode.removeChild(e)}var m,v,b,y,g,x,q,F,j,w,E,k,C,L,O;m="input[name]:not([type=file]):not([type=reset]):not([type=submit]):not([type=checkbox]):not([type=radio]):not(:disabled),input[name][type=submit]:focus,button[name][type=submit]:focus,button[name]:not([type]):focus,input[name][type=checkbox]:checked:not(:disabled),input[name][type=radio]:checked:not(:disabled),textarea[name]:not(:disabled),select[name]:not(:disabled) [selected=selected]",v=e.document,b=e.encodeURIComponent,y=e.URL,g=v.createRange(),x=e.fetch,q=e.FormData,F=Function.bind.bind(Function.call),j=F([].forEach),w=F(g.createContextualFragment,g),O=["html","svg","xml"],(E=t()).fetchers=t(),k=t(),C=t(),L=[],E.fetchers.form=function(e){var t,o=new y(e.action||e.ownerDocument.location.href),i=e.method;return"post"===i?t=new q(e):(o.search+=o.search.indexOf("?")>-1?"":"?",j(n(m,e),r,o)),E.request(o,i,t)},E.fetchers.a=function(e){return E.request(e.href,"get")},E.fetcher=function(e){var t=e.nodeName.toLowerCase();return E.fetchers[t](e)},E.trigger=function(e){return E.onTimeout(e)?E:(d(e.response.result,!0).then(e.resolve).then(function(){return e}),E)},E.on=function(e,t){return k[e]=k[e]||[],k[e].indexOf(t)<0&&k[e].push(t),E},E.onTimeout=function(e){return 408===e.response.status&&(e.retry(),!0)},E.populate=function(e){return d(e||v)},E.request=function(e,n,r){var o,i;return o=t(C),i=t(),o.options=i,o.url=e,i.headers=t(),i.headers["X-Requested-With"]="XMLHttpRequest",i.method=n,i.body=r,o},E.fetchFromEvent=function(e){E.fetcher(e.target).fetch(E.trigger),e.preventDefault()},E.defaults=function(){return E.on("a",function(e,t){e.addEventListener("click",E.fetchFromEvent),t()}),E.on("form",function(e,t){e.addEventListener("submit",l),t()}),E},E.utils=t(),E.utils.create=t,E.utils.demethodize=F,E.utils.forEach=j,E.utils.$=function(e,t){return t=t||v,void 0===e?t:t.querySelector(e)},E.utils.$$=n,C.body=function(e,t){return this.options.body.append(e,t),this},C.credentials=function(e){return this.options.credentials=e||"same-origin",this},C.fetch=function(e){var n;return n=t(),n.request=this,L.push(n),new Promise(function(t,r){n.request.resolve=t,n.reject=r,n.trigger=e,i()})},C.retry=function(){return L[0]&&L[0].request===this?(L.unshift(1),L.next(),this):this},C.header=function(e,t){return this.options.headers[e]=t,this},C.option=function(e,t){return this.options[e]=t,this},"object"==typeof module&&"object"==typeof module.exports?module.exports=E:"function"==typeof define&&define.amd?define([],function(){return E}):e.anticore=E}(Function("return this")());