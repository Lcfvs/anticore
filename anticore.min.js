/*
 Copyright MIT 2017 Lcf.vs
 https://github.com/Lcfvs/anticore
 */
!function(e){"use strict";function t(e,t){return Object.create(e||null,t)}function n(e,t){return(t||b).querySelectorAll(e)}function r(e){var t;return t=b.createElement("body"),t.innerHTML=e,t}function o(e){(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(this.search+="&"+y(("option"===e.nodeName.toLowerCase()?e.parentNode:e).name)+"="+y(e.value).replace(/%20/g,"+"))}function i(){O.shift(),O.length&&u()}function u(){var e;if(!O[1])return e=O[0],q(e.request.url,e.request.options).then(s).then(c).then(e.trigger||e.request.resolve).then(i).catch(e.reject)}function s(e){var t,n;return t=((e.headers.get("content-type")||"application/octet-stream").match(/json|html|svg|xml|text(?=\/plain)/)||["blob"])[0],n=O[0],n.type=t,n.request.response=e,e[k.indexOf(t)>-1?"text":t]()}function c(e){var t;return t=O[0],k.indexOf(t.type)>-1?t.request.response.result=r(e):t.request.response.result=e,t.request}function a(e){var t;if(!(t=this.shift()))return e&&e();t[0](t[1],this.next,this.loaded)}function f(e){var t,r;(t=this).selector=e,r=n(e,t.container),w(r,h,t)}function h(e){var t;(t=this).element=e,w(L[t.selector],d,t)}function d(e){this.push([e,this.element,this.loaded])}function l(e,t){return new Promise(function(n){var r;(r=[]).container=e,r.loaded=t,w(Object.keys(L),f,r),r.next=a.bind(r,n),r.next()})}function p(e){w(n(".error",e.target),m),F.fetchFromEvent(e)}function m(e){e.parentNode.removeChild(e)}var v,b,y,g,q,x,E,w,F,L,j,O,k;v="input[name]:not([type=file]):not([type=reset]):not([type=submit]):not([type=checkbox]):not([type=radio]):not(:disabled),input[name][type=submit]:focus,button[name][type=submit]:focus,button[name]:not([type]):focus,input[name][type=checkbox]:checked:not(:disabled),input[name][type=radio]:checked:not(:disabled),textarea[name]:not(:disabled),select[name]:not(:disabled) [selected=selected]",b=e.document,y=e.encodeURIComponent,g=e.URL,q=e.fetch,x=e.FormData,E=Function.bind.bind(Function.call),w=E([].forEach),k=["html","svg","xml"],(F=t()).fetchers=t(),L=t(),j=t(),O=[],F.fetchers.form=function(e){var t,r=new g(e.action||e.ownerDocument.location.href),i=e.method;return"post"===i?t=new x(e):(r.search+=r.search.indexOf("?")>-1?"":"?",w(n(v,e),o,r)),F.request(r,i,t)},F.fetchers.a=function(e){return F.request(e.href,"get")},F.fetcher=function(e){var t=e.nodeName.toLowerCase();return F.fetchers[t](e)},F.trigger=function(e){return F.onTimeout(e)?F:(l(e.response.result,!0).then(e.resolve).then(function(){return e}),F)},F.on=function(e,t){return L[e]=L[e]||[],L[e].indexOf(t)<0&&L[e].push(t),F},F.onTimeout=function(e){return 408===e.response.status&&(e.retry(),!0)},F.populate=function(e){return l(e||b)},F.request=function(e,n,r){var o,i;return o=t(j),i=t(),o.options=i,o.url=e,i.headers=t(),i.headers["X-Requested-With"]="XMLHttpRequest",i.method=n,i.body=r,o},F.fetchFromEvent=function(e){return F.fetcher(e.target).fetch(F.trigger).catch(F.onError),e.preventDefault(),!1},F.onError=console.error.bind(console),F.defaults=function(){return F.on("a:not([download]):not([target]),a[target=_self]:not([download])",function(t,n){"ontouchstart"in e&&t.addEventListener("touchend",F.fetchFromEvent),t.addEventListener("mouseup",F.fetchFromEvent),n()}),F.on("form:not([target]),form[target=_self]",function(e,t){e.addEventListener("submit",p),t()}),F},F.utils=t(),F.utils.create=t,F.utils.demethodize=E,F.utils.forEach=w,F.utils.$=function(e,t){return t=t||b,void 0===e?t:t.querySelector(e)},F.utils.$$=n,j.body=function(e,t){return this.options.body.append(e,t),this},j.credentials=function(e){return this.options.credentials=e||"same-origin",this},j.fetch=function(e){var n;return n=t(),n.request=this,O.push(n),new Promise(function(t,r){n.request.resolve=t,n.reject=r,n.trigger=e,u()})},j.retry=function(){return O[0]&&O[0].request===this?(O.unshift(1),O.next(),this):this},j.header=function(e,t){return this.options.headers[e]=t,this},j.option=function(e,t){return this.options[e]=t,this},"object"==typeof module&&"object"==typeof module.exports?module.exports=F:"function"==typeof define&&define.amd?define([],function(){return F}):e.anticore=F}(Function("return this")());