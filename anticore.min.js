/*
 Copyright MIT 2017 Lcf.vs
 https://github.com/Lcfvs/anticore
 */
void function(e){"use strict"
function t(){y.shift(),y.length&&n()}function n(){var e
if(!y[1])return e=y[0],l(e.request.url,e.request.options).then(r).then(o).then(e.trigger||e.request.resolve).then(t)["catch"](e.reject)}function r(e){var t,n
return t=((e.headers.get("content-type")||"application/octet-stream").match(/json|html|svg|xml|text(?=\/plain)/)||["blob"])[0],n=y[0],n.type=t,n.request.response=e,e[j.indexOf(t)>-1?"text":t]()}function o(e){var t
return t=y[0],j.indexOf(t.type)>-1?t.request.response.result=v(e):t.request.response.result=e,t.request}function i(e){var t
return(t=this.shift())?void t[0](t[1],this.next,this.loaded):e&&e()}function s(e){var t,n
t=this,t.selector=e,n=t.container.querySelectorAll(e),m(n,u,t)}function u(e){var t
t=this,t.element=e,m(x[t.selector],c,t)}function c(e){this.push([e,this.element,this.loaded])}function h(e,t){var n
return n=[],n.container=e,n.loaded=!!t,m(Object.keys(x),s,n),n.next=i.bind(n,t),n.next(),g}var a,f,l,d,p,m,v,q,g,x,b,y,j
a=e.document,f=a.createRange(),l=e.fetch,d=e.FormData,p=Function.bind.bind(Function.call),m=p([].forEach),v=p(f.createContextualFragment,f),j=["html","svg","xml"],q=function(e){return Object.create(e||null)},g=e.anticore=q(),g.fetchers=q(),x=q(),b=q(),y=[],g.fetchers.form=function(e){return g.request(e.action,e.method,new d(e))},g.fetchers.a=function(e){return g.request(e.href,"get")},g.fetcher=function(e){var t
return t=e.nodeName.toLowerCase(),g.fetchers[t](e)},g.trigger=function(e){return g.onTimeout(e)?g:(setTimeout(h,0,e.response.result,e.resolve),g)},g.on=function(e,t){return x[e]=x[e]||[],x[e].indexOf(t)<0&&x[e].push(t),g},g.onTimeout=function(e){return 408===e.response.status?(e.retry(),!0):!1},g.populate=function(e){return h(e)},g.request=function(e,t,n){var r,o
return r=q(b),o=q(),r.options=o,r.url=e,o.headers=q(),o.headers["X-Requested-With"]="XMLHttpRequest",o.method=t,o.body=n,r},b.body=function(e,t){return this.options.body.append(e,t),this},b.credentials=function(e){return void 0===e&&(e="same-origin"),this.options.credentials=e,this},b.fetch=function(e){var t
return t=q(),t.request=this,y.push(t),new Promise(function(r,o){t.request.resolve=r,t.reject=o,t.trigger=e,n()})},b.retry=function(){return y[0]&&y[0].request===this?(y.unshift(1),y.next(),this):void 0},b.header=function(e,t){return this.options.headers[e]=t,this},b.option=function(e,t){return this.options[e]=t,this}}(this);