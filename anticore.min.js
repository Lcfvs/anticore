/* Copyright MIT 2017 Lcf.vs - https://github.com/Lcfvs/anticore */
!function(e){"use strict";function t(e){(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(this.search+="&"+m(("option"===e.nodeName.toLowerCase()?e.parentNode:e).name)+"="+m(e.value).replace(/%20/g,"+"))}function n(){L.shift(),L.length&&r()}function r(){var e;if(!L[1])return e=L[0],g(e.request.url,e.request.options).then(o).then(i).then(e.trigger||e.request.resolve).then(n).catch(e.reject)}function o(e){var t,n;return t=((e.headers.get("content-type")||"application/octet-stream").match(/json|html|svg|xml|text(?=\/plain)/)||["blob"])[0],n=L[0],n.type=t,n.request.response=e,e[O.indexOf(t)>-1?"text":t]()}function i(e){var t;return t=L[0],O.indexOf(t.type)>-1?t.request.response.result=F(e):t.request.response.result=e,t.request}function s(e){var t;if(!(t=this.shift()))return e&&e();t[0](t[1],this.next,this.loaded)}function u(e){var t,n;(t=this).selector=e,n=t.container.querySelectorAll(e),x(n,c,t)}function c(e){var t;(t=this).element=e,x(C[t.selector],a,t)}function a(e){this.push([e,this.element,this.loaded])}function h(e,t){return new Promise(function(n){var r;(r=[]).container=e,r.loaded=t,x(Object.keys(C),u,r),r.next=s.bind(r,n),r.next()})}function f(e){x(e.target.querySelectorAll(".error"),l),k.fetchFromEvent(e)}function l(e){e.parentNode.removeChild(e)}var d,p,m,v,b,g,y,q,x,F,w,k,C,E,L,O;d="input[name]:not([type=file]):not([type=reset]):not([type=submit]):not([type=checkbox]):not([type=radio]):not(:disabled),input[name][type=submit]:focus,button[name][type=submit]:focus,button[name]:not([type]):focus,input[name][type=checkbox]:checked:not(:disabled),input[name][type=radio]:checked:not(:disabled),textarea[name]:not(:disabled),select[name]:not(:disabled) [selected=selected]",p=e.document,m=e.encodeURIComponent,v=e.URL,b=p.createRange(),g=e.fetch,y=e.FormData,q=Function.bind.bind(Function.call),x=q([].forEach),F=q(b.createContextualFragment,b),O=["html","svg","xml"],w=function(e){return Object.create(e||null)},(k=e.anticore=w()).fetchers=w(),C=w(),E=w(),L=[],k.fetchers.form=function(e){var n,r=new v(e.action||e.ownerDocument.location.href),o=e.method;return"post"===o?n=new y(e):(r.search+=r.search.indexOf("?")>-1?"":"?",x(e.querySelectorAll(d),t,r)),k.request(r,o,n)},k.fetchers.a=function(e){return k.request(e.href,"get")},k.fetcher=function(e){var t;return t=e.nodeName.toLowerCase(),k.fetchers[t](e)},k.trigger=function(e){return k.onTimeout(e)?k:(h(e.response.result,!0).then(e.resolve).then(function(){return e}),k)},k.on=function(e,t){return C[e]=C[e]||[],C[e].indexOf(t)<0&&C[e].push(t),k},k.onTimeout=function(e){return 408===e.response.status&&(e.retry(),!0)},k.populate=function(e){return h(e)},k.request=function(e,t,n){var r,o;return r=w(E),o=w(),r.options=o,r.url=e,o.headers=w(),o.headers["X-Requested-With"]="XMLHttpRequest",o.method=t,o.body=n,r},k.fetchFromEvent=function(e){k.fetcher(e.target).fetch(k.trigger),e.preventDefault()},k.defaults=function(){return k.on("a",function(e,t){e.addEventListener("click",k.fetchFromEvent),t()}),k.on("form",function(e,t){e.addEventListener("submit",f),t()}),k},E.body=function(e,t){return this.options.body.append(e,t),this},E.credentials=function(e){return void 0===e&&(e="same-origin"),this.options.credentials=e,this},E.fetch=function(e){var t;return t=w(),t.request=this,L.push(t),new Promise(function(n,o){t.request.resolve=n,t.reject=o,t.trigger=e,r()})},E.retry=function(){return L[0]&&L[0].request===this?(L.unshift(1),L.next(),this):this},E.header=function(e,t){return this.options.headers[e]=t,this},E.option=function(e,t){return this.options[e]=t,this}}(Function("return this")());