/*
Copyright MIT 2017 Lcf.vs
https://github.com/Lcfvs/anticore
*/
void function(e){"use strict"
function t(e){this.search+="&"+l(("option"===e.nodeName.toLowerCase()?e.parentNode:e).name)+"="+l(e.value).replace(/%20/g,"+")}function n(){k.shift(),k.length&&r()}function r(){var e
if(!k[1])return e=k[0],v(e.request.url,e.request.options).then(o).then(i).then(e.trigger||e.request.resolve).then(n)["catch"](e.reject)}function o(e){var t,n
return t=((e.headers.get("content-type")||"application/octet-stream").match(/json|html|svg|xml|text(?=\/plain)/)||["blob"])[0],n=k[0],n.type=t,n.request.response=e,e[R.indexOf(t)>-1?"text":t]()}function i(e){var t
return t=k[0],R.indexOf(t.type)>-1?t.request.response.result=g(e):t.request.response.result=e,t.request}function s(e){var t
return(t=this.shift())?void t[0](t[1],this.next,this.loaded):e&&e()}function u(e){var t,n
t=this,t.selector=e,n=t.container.querySelectorAll(e),q(n,c,t)}function c(e){var t
t=this,t.element=e,q(O[t.selector],a,t)}function a(e){this.push([e,this.element,this.loaded])}function h(e,t){return new Promise(function(n){var r
r=[],r.container=e,r.loaded=t,q(Object.keys(O),u,r),r.next=s.bind(r,n),r.next()})}var f,d,l,p,m,v,y,b,q,g,x,w,O,j,k,R
f="input[name]:not([type=file]):not([type=reset]):not([type=submit]):not([type=checkbox]):not([type=radio]):not(:disabled),input[name][type=submit]:focus,button[name][type=submit]:focus,button[name]:not([type]):focus,input[name][type=checkbox]:checked,input[name][type=radio]:checked,textarea[name]:not(:disabled),select[name]:not(:disabled) [selected=selected]",d=e.document,l=e.encodeURIComponent,p=e.URL,m=d.createRange(),v=e.fetch,y=e.FormData,b=Function.bind.bind(Function.call),q=b([].forEach),g=b(m.createContextualFragment,m),R=["html","svg","xml"],x=function(e){return Object.create(e||null)},w=e.anticore=x(),w.fetchers=x(),O=x(),j=x(),k=[],w.fetchers.form=function(e){var n,r=new p(e.action||e.ownerDocument.location.href),o=e.method
return"post"===o?n=new y(e):(r.search+=r.search.indexOf("?")>-1?"":"?",q(e.querySelectorAll(f),t,r)),w.request(r,o,n)},w.fetchers.a=function(e){return w.request(e.href,"get")},w.fetcher=function(e){var t
return t=e.nodeName.toLowerCase(),w.fetchers[t](e)},w.trigger=function(e){return w.onTimeout(e)?w:(h(e.response.result,!0).then(e.resolve),w)},w.on=function(e,t){return O[e]=O[e]||[],O[e].indexOf(t)<0&&O[e].push(t),w},w.onTimeout=function(e){return 408===e.response.status?(e.retry(),!0):!1},w.populate=function(e){return h(e)},w.request=function(e,t,n){var r,o
return r=x(j),o=x(),r.options=o,r.url=e,o.headers=x(),o.headers["X-Requested-With"]="XMLHttpRequest",o.method=t,o.body=n,r},j.body=function(e,t){return this.options.body.append(e,t),this},j.credentials=function(e){return void 0===e&&(e="same-origin"),this.options.credentials=e,this},j.fetch=function(e){var t
return t=x(),t.request=this,k.push(t),new Promise(function(n,o){t.request.resolve=n,t.reject=o,t.trigger=e,r()})},j.retry=function(){return k[0]&&k[0].request===this?(k.unshift(1),k.next(),this):void 0},j.header=function(e,t){return this.options.headers[e]=t,this},j.option=function(e,t){return this.options[e]=t,this}}(this);